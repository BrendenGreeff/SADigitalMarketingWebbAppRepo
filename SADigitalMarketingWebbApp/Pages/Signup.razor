@layout Signup_Layout

@using DataLibrary
@using SADigitalMarketingWebbApp.Models
@using Microsoft.Extensions.Configuration

@page "/signup"

@inject NavigationManager UriHelper
@inject IDataAccess _data
@inject IConfiguration _config


<style>
    .div {
        margin: auto;
        width: auto;
    }

    label {
        display: inline-block;
        width: 90px;
        text-align: left;
        font-weight: bold;
    }

    .backgroundimg {
        background-image: url(https://images.pexels.com/photos/1103970/pexels-photo-1103970.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=750&w=1260);
        width: 1880px;
        height: 880px;
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
    }

    .heading {
        font-size: 145px;
        font-weight: bold;
    }


    .container {
        background-color: aliceblue;
        width: 25%;
        height: 85%;
        text-align: center;
    }
</style>

<div class="div">
    <div class="backgroundimg" align="center">
        <h3 class="heading">Signup</h3>
        <br />
        <h5>Please enter your details below!</h5>
        <br />
        <label>First Name</label>
        <input type="text" id="firstname" @bind="FirstName" placeholder="Enter First Name" />
        <br />
        <br />
        <label>Last Name</label>
        <input type="text" id="lastname" @bind="LastName" placeholder="Enter Last Name">
        <br />
        <br />
        <label>Username</label>
        <input type="text" id="username" @bind="Username" placeholder="Enter Username">
        <br />
        <br />
        <label>Email        </label>
        <input type="text" id="email" @bind="Email" placeholder="Enter Email Address">
        <br />
        <br />
        <label>Phone Number</label>
        <input type="number" id="phonenumber" @bind="PhoneNumber" placeholder="Enter Phone Number">
        <br />
        <br />
        <label>Date of Birth</label>
        <input type="number" id="dateofbirth" @bind="DateofBirth" placeholder="Enter Date of Birth">
        <br />
        <br />
        <label>Password</label>
        <input type="password" id="password" @bind="Password" placeholder="Enter Password">
        <br />
        <br />
        <label>Confirm Password</label>
        <input type="password" id="confirmpassword" @bind="ConfirmPassword" placeholder="Enter Password Again">
        <br />

        <p style="color:@Color"><b>@text</b></p>

        <button type="submit" class="btn-primary" @onclick="Submit">Submit</button>
        <br />
    </div>

</div>

@if (users == null)
{
    <p><em>Loading...</em></p>
}
else {
    @foreach (var p in users)
     {
        <p>
            @p.User_Username
            @p.User_Fname
        </p>
     }
}

@code {

    List<UsersModel> users;

    protected override async Task OnInitializedAsync()
    {
        string sql = "SELECT * FROM users";
        users = await _data.LoadData<UsersModel, dynamic>(sql, new { }, _config.GetConnectionString("default"));
    }

    private string Username { get; set; }
    private string Password { get; set; }
    private string FirstName { get; set; }
    private string LastName { get; set; }
    private string Email { get; set; }
    private string DateofBirth { get; set; }
    private string ConfirmPassword { get; set; }
    private string PhoneNumber { get; set; }

    string Color = "black";
    string text = "";

    private void Submit()
    {
        if (Password == ConfirmPassword)
        {
            if (FirstName != "" && LastName != "" && Username != "" && Email != "" && DateofBirth != null && Password != null && ConfirmPassword != null)
            {
                Color = "green";
                text = "Welcome Guest!";

                FirstName = "";
                LastName = "";
                Username = "";
                Email = "";
                DateofBirth = "";
                Password = "";
                ConfirmPassword = "";
                UriHelper.NavigateTo("/");
            }
            else
            {
                Color = "red";
                text = "Please fill in all the fields!";

                FirstName = "";
                LastName = "";
                Username = "";
                Email = "";
                DateofBirth = "";
                Password = "";
                ConfirmPassword = "";

            }

        }
        else
        {
            Color = "red";
            text = "Passwords dont match, retry!";

            FirstName = "";
            LastName = "";
            Username = "";
            Email = "";
            DateofBirth = "";
            Password = "";
            ConfirmPassword = "";

        }

    }



}
